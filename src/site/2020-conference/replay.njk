<!-- prettier-ignore -->
{% import "components/modal.njk" as modal %}

<!-- prettier-ignore -->
{% extends "layouts/_full-page.njk" %}

<!-- prettier-ignore -->
{% set title = "2020 RxCon Replay - RadicalxChange" %}
<!-- prettier-ignore -->
{% set headerText = "2020 RxCon Replay" %}

<!-- prettier-ignore -->
{% block content %}
<div class="flex bg-golden-fizz-100">
  <div class="lg:w-span7 pb-base lg:pb-lg/xl px-base lg:pl-lg/lg lg:pr-lg/base">
    <!-- lg-tall:top-0 lg-tall:sticky lg-tall:pt-lg/base lg-tall:-mt-lg/base -->
    <div class="bg-golden-fizz-100">
      <div class="youtube-container" data-youtube-container>
        <iframe
          src="https://www.youtube-nocookie.com/embed/S6DiS1NkxiQ"
          frameborder="0"
          allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        ></iframe>
      </div>
    </div>
    <div class="mt-base lg:mt-lg/lg">
      <h3
        class="text-xl lg:text-lg/xl mb-base lg:mb-lg/base"
        data-youtube-title
      ></h3>
      <p class="whitespace-pre-wrap" data-youtube-description></p>
      <!-- <p class="mb-base lg:mb-lg/base">
        Thank you for a great RadicalxChange Annual Conference 2020. If you like
        this replay, join the movement. Get involved or make a small gift. We
        need you!
      </p> 

      <div class="flex flex-col lg:flex-row">
        <ul class="lg:mr-lg/lg">
          <li class="mb-xs lg:mb-lg/xs">
            <a
              class="animated-link"
              href="/chapters"
              onclick="fathom.trackGoal('LWD6ES0J', 0);"
              >Join a local chapter</a
            >
          </li>
          <li class="mb-xs lg:mb-lg/xs">
            <a
              class="animated-link"
              href="#"
              onclick="fathom.trackGoal('KB8V0MZ8', 0);"
              data-modal-trigger="subscribe"
              >Subscribe to our newsletter</a
            >
          </li>
        </ul>
        <ul class="overflow-y-auto">
          <li class="mb-xs lg:mb-lg/xs">
            <a
              class="animated-link"
              href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=Q66E4MUK6K6KQ"
              onclick="fathom.trackGoal('VOPKBH4N', 0);"
              >Donate via PayPal</a
            >
          </li>
          <li class="mb-xs lg:mb-lg/xs">
            <a
              class="animated-link"
              href="https://commerce.coinbase.com/checkout/a68957cd-9253-4b60-ac6a-2b0d3f472647"
              onclick="fathom.trackGoal('JEBSM3Y8', 0);"
              >Donate via Crypto</a
            >
          </li>
        </ul
      </div>-->
    </div>
  </div>
  <ul class="lg:w-span5 pb-base lg:pb-lg/xl px-base lg:pl-lg/base lg:pr-lg/lg">
    {% for v in youtube2020 %}
    <li class="mb-base lg:mb-lg/base">
      <a class="flex items-start" href="#v{{ v.videoId }}">
        <img
          src="/images/ui/icon-youtube.svg"
          class="conference-replay-video_icon"
        />
        <div>
          <h4>{{ v.title }}</h4>
          <p class="text-xs lg:text-lg/xs">{{ v.speakers }}</p>
        </div>
      </a>
    </li>
    {% endfor %}
  </ul>
</div>
<!-- prettier-ignore -->
{% for v in youtube2020 %}
<!-- prettier-ignore -->
<script type="text/plain" id="title-{{ v.videoId }}">{{ v.title | safe }}</script>
<!-- prettier-ignore -->
<script type="text/plain" id="description-{{ v.videoId }}">{{ v.description | safe }}</script>
<!-- prettier-ignore -->
{% endfor %}
<!-- prettier-ignore -->
{% endblock %}
<!-- prettier-ignore -->
{% block bodyScripts %}
<script>
  const youtubeContainer = $("[data-youtube-container]");
  const youtubeTitle = $("[data-youtube-title]");
  const youtubeDescription = $("[data-youtube-description]");

  function showVideo(videoId = "{{youtube2020[0].videoId}}") {
    youtubeContainer.empty();
    youtubeContainer.append(
      $(
        `<iframe src="https://www.youtube-nocookie.com/embed/${videoId}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`
      )
    );
    youtubeTitle.empty();
    youtubeTitle.append($(`#title-${videoId}`).contents().clone());
    youtubeDescription.empty();
    youtubeDescription.append($(`#description-${videoId}`).contents().clone());
  }

  const hashRegex = /^#v(.*)$/;
  $(window).on("hashchange", function (e) {
    const match = hashRegex.exec(window.location.hash);
    if (match) {
      showVideo(match[1]);
    } else {
      showVideo();
    }
  });
  const match = hashRegex.exec(window.location.hash);
  if (match) {
    showVideo(match[1]);
  } else {
    showVideo();
  }
</script>
<!-- prettier-ignore -->
{% endblock %}
